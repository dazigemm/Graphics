<script src=M.js></script>
<script src=lib2k.js></script>
<script src=SHAPE.js></script>

<body bgcolor=black text=white>
<center>
	<table border="5px solid white">
		<tr>
			<td>
				<canvas id='canvas1' width=600 height=500></canvas>
			</td>
			<td width=50></td>
			<td valign=top>
				<h1> The Three Little Pigs - An Animated Retelling </h1>
				Once upon a time, there lived three little pigs.
				At the age of 18, they were told to grow up and be self sufficient. So they packed their toothbrush, said good-bye to their parents and set off to find a new home.   
			</td>
		</tr>
		<tr>
			<td>
				<canvas id='canvas2' width=600 height=500></canvas>
			</td>
			<td width=50></td>
			<td valign=top>
				The oldest pig... and so he built a brick house.
			</td>
		</tr>
		<tr>
			<td>
				<canvas id='canvas3' width=600 height=500></canvas>
			</td>
			<td width=50></td>
			<td valign=top>
				Piglet number two had always dreamed of living in a tree house. Unfortunately, he discovered he could not climb a tree. So he had to settle for a house made of sticks.
			</td>
		</tr>
		<tr>
			<td>
				<canvas id='canvas4' width=600 height=500></canvas>
			</td>
			<td width=50></td>
			<td valign=top>
				The youngest pig stumbled across a farm for sale. Although he had never spent a day at a farm before, he felt a desire to try his hand at farming. "What better way to understand the farm animals then to learn how they live?" thought the young piglet. Therefore, he decided to spend some time in a straw house.
			</td>
		</tr>
		<tr>
			<td>
				<canvas id='canvas5' width=600 height=500></canvas>
			</td>
			<td width=50></td>
			<td valign=top>
				Along came a lone wolf. Huffity Puff! Down came the houses of stick and straw. 
			</td>
		</tr>
		<tr>
			<td>
				<canvas id='canvas6' width=600 height=500></canvas>
			</td>
			<td width=50></td>
			<td valign=top>
				The End
			</td>
		</tr>
		<tr>
			<td>
				<canvas id='canvas7' width=600 height=500></canvas>
			</td>
			<td width=50></td>
			<td valign=top>
				The End
			</td>
		</tr>	
	</table>
</center>
</body>
   
<script>

var vs = '\
attribute vec3 aPos, aNor;\n\
attribute vec2 aUV;\n\
varying   vec3 vPos, vNor;\n\
varying   vec2 vUV;\n\
uniform   mat4 matrix, invMatrix;\n\
void main() {\n\
   vec4 pos = matrix * vec4(aPos, 1.);\n\
   vec4 nor = vec4(aNor, 0.) * invMatrix;\n\
   gl_Position = pos;\n\
   vPos = pos.xyz;\n\
   vNor = nor.xyz;\n\
   vUV  = aUV;\n\
}\n\
';

var fs1 = '\
varying vec3 vPos, vNor;\n\
varying vec2 vUV;\n\
void main() {\n\
   vec3 normal = normalize(vNor);\n\
   vec3 c = vec3(.1,.1,.1);\n\
   c += vec3(.7,.7,1.) * max(0.,dot(normal, vec3( .7, .7, .7)));\n\
   c += vec3(.5,.3,.1) * max(0.,dot(normal, vec3(-.7,-.7,-.7)));\n\
   gl_FragColor = vec4(sqrt(c), 1.);\n\
}\n\
';

var fs2 = '\
varying vec3 vPos, vNor;\n\
varying vec2 vUV;\n\
uniform sampler2D uSampler;\n\
void main() {\n\
   vec3 normal = normalize(vNor);\n\
   vec3 c = vec3(.1,.1,.1);\n\
   c += vec3(.7,.7,1.) * max(0.,dot(normal, vec3( .7, .7, .7)));\n\
   c += vec3(.5,.3,.1) * max(0.,dot(normal, vec3(-.7,-.7,-.7)));\n\
   vec4 texture = texture2D(uSampler, vUV);\n\
   c *= texture.rgb;\n\
   gl_FragColor = vec4(sqrt(c), 1.);\n\
}\n\
';

   var obj1, obj2, obj3, obj4, obj5, obj6, tileR, brickH, woodR, woodH, strawR, strawH;

   var scene1 = new Scene();// canvas 1
   var scene2 = new Scene();// canvas 2
   var scene3 = new Scene();// canvas 3
   var scene4 = new Scene();// canvas 4
   var scene5 = new Scene();// canvas 5
   var scene6 = new Scene();// canvas 6

   var material1 = new Material(vs, fs2);
   material1.setTexture('imgs/roof.jpg');// tile
   var material2 = new Material(vs, fs2);
   material2.setTexture('imgs/brick.png');// brick
   var material3 = new Material(vs, fs2);
   material3.setTexture('imgs/wood-2.jpg');// wood
   var material4 = new Material(vs, fs2);
   material4.setTexture('imgs/straw-3.jpg');// straw
   
   var materialT = new Material(vs, fs2);
   materialT.setTexture('imgs/roof.jpg');// tile
   var materialB = new Material(vs, fs2);
   materialB.setTexture('imgs/brick.png');// brick
   var materialW = new Material(vs, fs2);
   materialW.setTexture('imgs/wood-2.jpg');// wood
   var materialS = new Material(vs, fs2);
   materialS.setTexture('imgs/straw-3.jpg');// straw

   obj1 = new SceneObject();// tile roof
   obj1.setVertices(SHAPE.cylinder(3));
   obj1.setMaterial(material1);
   scene6.addObject(obj1);
   
   obj2 = new SceneObject();// brick house
   obj2.setVertices(SHAPE.cylinder(4));
   obj2.setMaterial(material2);
   scene6.addObject(obj2);
   
   obj3 = new SceneObject();// wood roof
   obj3.setVertices(SHAPE.cylinder(3));
   obj3.setMaterial(material3);
   scene6.addObject(obj3);
   
   obj4 = new SceneObject();// wood house
   obj4.setVertices(SHAPE.cylinder(4));
   obj4.setMaterial(material3);
   scene6.addObject(obj4);
   
   obj5 = new SceneObject();// straw roof
   obj5.setVertices(SHAPE.cylinder(3));
   obj5.setMaterial(material4);
   scene6.addObject(obj5);
   
   obj6 = new SceneObject();// straw house
   obj6.setVertices(SHAPE.cylinder(4));
   obj6.setMaterial(material4);
   scene6.addObject(obj6);
    
   tileR = new SceneObject();// tile roof
   tileR.setVertices(SHAPE.cylinder(3));
   tileR.setMaterial(materialT);
   scene2.addObject(tileR);
   
   brickH = new SceneObject();// brick house
   brickH.setVertices(SHAPE.cylinder(4));
   brickH.setMaterial(materialB);
   scene2.addObject(brickH);

   woodR = new SceneObject();// wood roof
   woodR.setVertices(SHAPE.cylinder(3));
   woodR.setMaterial(materialW);
   scene3.addObject(woodR);
   
   woodH = new SceneObject();// wood house
   woodH.setVertices(SHAPE.cylinder(4));
   woodH.setMaterial(materialW);
   scene3.addObject(woodH);

   strawR = new SceneObject();// straw roof
   strawR.setVertices(SHAPE.cylinder(3));
   strawR.setMaterial(materialS);
   scene4.addObject(strawR);
   
   strawH = new SceneObject();// straw house
   strawH.setVertices(SHAPE.cylinder(4));
   strawH.setMaterial(materialS);
   scene4.addObject(strawH);

   canvas1.scene = scene1;
   
   canvas2.scene = scene2;
   canvas3.scene = scene3;
   canvas4.scene = scene4;

   canvas5.scene = scene5;
   canvas6.scene = scene6;
   
   var m = M.identityMatrix();
//*
gl_start(canvas2,
   function(time) {
	
	M.identity(m);
	M.rotateY(m, Math.PI/2);
	M.translate(m, [0, 0, -.68]);
	M.scale(m, 0.9);

	M.save(m);// tile roof
	 M.scale(m, .25, .15, .25);
	 M.translate(m, [0, 1.3, 0]);
	 M.rotateZ(m, Math.PI * 11 / 6);
	 tileR.setMatrix(m);
	M.restore(m);

	M.save(m);// brick house
	 M.scale(m, .2, .2, .3);
	 M.rotateY(m, Math.PI/4);
	 M.rotateX(m, Math.PI/2);
	 brickH.setMatrix(m);
	M.restore(m);
   }
);
//*
gl_start(canvas3,
   function(time) {
	
	M.identity(m);
	M.rotateY(m, Math.PI/2);
	M.translate(m, [0, 0, -.68]);
	M.scale(m, 0.9);
 
   	M.save(m);// stick roof
	 M.scale(m, .25, .15, .25);
	 M.translate(m, [0, 1.3, 0]);
	 M.rotateZ(m, Math.PI * 11 / 6);
	 woodR.setMatrix(m);
	M.restore(m);

	M.save(m);// stick house 
	 M.scale(m, .2, .2, .3);
	 //M.translate(m, [0, 0, 2.5]);
	 M.rotateY(m, Math.PI/4);
	 M.rotateX(m, Math.PI/2);
	 woodH.setMatrix(m);
	M.restore(m);
   }
);

gl_start(canvas4,
   function(time) {
   	M.save(m);// straw roof
	 M.scale(m, .25, .15, .25);
	 M.translate(m, [0, 1.3, 0]);
	 M.rotateZ(m, Math.PI * 11 / 6);
	 strawR.setMatrix(m);
	M.restore(m);

	M.save(m);// straw house 
	 M.scale(m, .2, .2, .3);
	 //M.translate(m, [0, 0, 5]);
	 M.rotateY(m, Math.PI/4);
	 M.rotateX(m, Math.PI/2);
	 strawH.setMatrix(m);
	M.restore(m);

   }
);
//*/
gl_start(canvas6,
   function(time) {
	
	M.identity(m);
	M.rotateY(m, Math.PI/2);
	M.translate(m, [0, 0, -.68]);
	M.scale(m, 0.9);

	M.save(m);// tile roof
	 M.scale(m, .25, .15, .25);
	 M.translate(m, [0, 1.3, 0]);
	 M.rotateZ(m, Math.PI * 11 / 6);
	 obj1.setMatrix(m);
	M.restore(m);

	M.save(m);// brick house
	 M.scale(m, .2, .2, .3);
	 M.rotateY(m, Math.PI/4);
	 M.rotateX(m, Math.PI/2);
	 obj2.setMatrix(m);
	M.restore(m);
  
   	M.save(m);// stick roof
	 M.scale(m, .25, .15, .25);
	 M.translate(m, [0, 1.3, 3]);
	 M.rotateZ(m, Math.PI * 11 / 6);
	 obj3.setMatrix(m);
	M.restore(m);

	M.save(m);// stick house 
	 M.scale(m, .2, .2, .3);
	 M.translate(m, [0, 0, 2.5]);
	 M.rotateY(m, Math.PI/4);
	 M.rotateX(m, Math.PI/2);
	 obj4.setMatrix(m);
	M.restore(m);

   	M.save(m);// straw roof
	 M.scale(m, .25, .15, .25);
	 M.translate(m, [0, 1.3, 6]);
	 M.rotateZ(m, Math.PI * 11 / 6);
	 obj5.setMatrix(m);
	M.restore(m);

	M.save(m);// straw house 
	 M.scale(m, .2, .2, .3);
	 M.translate(m, [0, 0, 5]);
	 M.rotateY(m, Math.PI/4);
	 M.rotateX(m, Math.PI/2);
	 obj6.setMatrix(m);
	M.restore(m);
//*/
   }
);


</script>

